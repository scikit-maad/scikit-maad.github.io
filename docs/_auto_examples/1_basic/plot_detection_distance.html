

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Detection distance estimation &mdash; scikit-maad 1.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Signal decomposition and false-color spectrograms" href="../2_advanced/plot_nmf_and_false_color_spectrogram.html" />
    <link rel="prev" title="Circadian soundscape" href="plot_circadian_spectrogram.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> scikit-maad
          

          
            
            <img src="../../_static/logo_maad_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../audio_dataset.html">Audio dataset</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sound.html">Sound processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rois.html">Segmentation methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Acoustic features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spl.html">Sound pressure level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../util.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Gallery</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Example gallery</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#basic-examples">Basic examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_find_rois_simple.html">Simple audio segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_audio_representation.html">Audio representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_circadian_spectrogram.html">Circadian soundscape</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Detection distance estimation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#advanced-examples">Advanced examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scikit-maad</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Example gallery</a> &raquo;</li>
        
      <li>Detection distance estimation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/_auto_examples/1_basic/plot_detection_distance.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-1-basic-plot-detection-distance-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="detection-distance-estimation">
<span id="sphx-glr-auto-examples-1-basic-plot-detection-distance-py"></span><h1>Detection distance estimation<a class="headerlink" href="#detection-distance-estimation" title="Permalink to this headline">¶</a></h1>
<p>When sound travels in air (or in water), initial acoustic signature may change
regarding distances due to attenuation. Sound attenuation in natural environment
is very complex to model. We propose to reduce the complexity by decomposing
the sound attenuation to three main sources of attenuation :
- the geometric attenuation (Ageo) also known as spreading loss or geometric
dispersion,
- the atmospheric attenuation (Aatm)
- and the habitat attenuation (Ahab). The later encompasses several sources of
attenuation and might be seen as a proxy.</p>
<p>Knowing the attenuation law and the sound level at each frequency, it is
possible to estimate the detection distance of each frequency component of
that sound</p>
<p>In this example, we will estimate the detection distance of each frequency
component of a sound that travels in rainforest at noon, when the ambient
sound level is the lowest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># import numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># import the graphic library</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="c1"># import maad</span>
<span class="kn">from</span> <span class="nn">maad</span> <span class="kn">import</span> <span class="n">sound</span><span class="p">,</span> <span class="n">spl</span><span class="p">,</span> <span class="n">util</span>
</pre></div>
</div>
<p>Let’s decide that the propagation sound is a wideband sound ranging from 0Hz
to 20000Hz with an initial sound pressure level of 80 dBSPL at 1m which
corresponds to the sum of the sound pressure level along the full frequency
bandwidth. So we need first to spread the intial sound pressure level over
this frequency bandwidth.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># frequency vector from 0Hz to 20000Hz, with 1000Hz resolution</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># Repartition of the initial sound pressure level along each frequency bin</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">L0</span></a> <span class="o">=</span> <span class="mi">80</span>
<span class="n">L0_per_bin</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">dBSPL_per_bin</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">L0</span></a><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L0_per_bin</span><span class="p">)</span>
<span class="c1"># Distance in m at which the initial sound pressure level is measured</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">r0</span></a> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[66.98970004 66.98970004 66.98970004 66.98970004 66.98970004 66.98970004
 66.98970004 66.98970004 66.98970004 66.98970004 66.98970004 66.98970004
 66.98970004 66.98970004 66.98970004 66.98970004 66.98970004 66.98970004
 66.98970004 66.98970004]
</pre></div>
</div>
<p>The detection distance is mostly driven by the sound pressure level of the
background noise (or ambient sound). Let’s define an array with the sound
pressure level experimentaly measured in a rainforest (French Guiana)
at noon for each frequency bin (from 0Hz to 20kHz).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L_bkg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">44.270917</span><span class="p">,</span> <span class="mf">27.586848</span><span class="p">,</span> <span class="mf">25.60843</span> <span class="p">,</span> <span class="mf">23.205826</span><span class="p">,</span> <span class="mf">20.631086</span><span class="p">,</span> <span class="mf">24.080126</span><span class="p">,</span>
                  <span class="mf">19.032034</span><span class="p">,</span> <span class="mf">33.455814</span><span class="p">,</span> <span class="mf">44.420644</span><span class="p">,</span> <span class="mf">19.751421</span><span class="p">,</span> <span class="mf">11.932672</span><span class="p">,</span>  <span class="mf">9.641225</span><span class="p">,</span>
                  <span class="mf">8.075566</span><span class="p">,</span>  <span class="mf">7.447614</span><span class="p">,</span>  <span class="mf">6.991958</span><span class="p">,</span>  <span class="mf">7.854252</span><span class="p">,</span> <span class="mf">11.911974</span><span class="p">,</span>  <span class="mf">4.192154</span><span class="p">,</span>
                  <span class="mf">3.234791</span><span class="p">,</span>  <span class="mf">2.936258</span><span class="p">])</span>
</pre></div>
</div>
<p>We know the initial sound pressure level LO at the distance r0 = 1m as well
as the sound pressure level of the background L_bkg, then it is possible
to estimate the detection distance for each frequency bin. We set the
temperature at 24°C and the relative humidity at 87% as there are common
values for rainforest. We also set the coefficient of attenuation of the
habitat to 0.02dB/kHz/m which is also representative of the attenuation of
rainforest habitat.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">detection_distance</span> <span class="p">(</span><span class="n">L_bkg</span><span class="p">,</span> <span class="n">L0_per_bin</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">r0</span></a><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">rh</span> <span class="o">=</span> <span class="mi">87</span><span class="p">,</span> <span class="n">a0</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
</pre></div>
</div>
<p>Display the detection distance for each frequency as a bar plot. We can
observe that the detection distance is highly variable from 10m at 8kHz till
81m for 4kHz. The low detection distance between 7kHz to 8kHz is due to the
stridulations of the insects that is very loud. It masks the propagation
of the audio signal at a very short distance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to add value labels</span>
<span class="k">def</span> <span class="nf">valuelabel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span>
                 <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
                 <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">m&#39;</span> <span class="o">%</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                 <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                <span class="p">)</span>

<span class="c1"># Create the figure and set the size</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span>

<span class="c1"># Create bars</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="c1"># Create names on the x-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Call function</span>
<span class="n">valuelabel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="c1"># Define labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Detection distance [m]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">)</span>

<span class="c1"># Show graphic</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot detection distance" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_detection_distance_001.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.232 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-1-basic-plot-detection-distance-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/bb3eea8d5cb97c0f9335b0abc38789d0/plot_detection_distance.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_detection_distance.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/53098b3b3b74b704b625d01d4579eafd/plot_detection_distance.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_detection_distance.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../2_advanced/plot_nmf_and_false_color_spectrogram.html" class="btn btn-neutral float-right" title="Signal decomposition and false-color spectrograms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_circadian_spectrogram.html" class="btn btn-neutral float-left" title="Circadian soundscape" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, scikit-maad development team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>